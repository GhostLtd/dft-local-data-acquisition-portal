{%- extends "@GhostGovUkCore/base.html.twig" -%}

{%- set page_title_domain = page_title_domain ?? 'messages' -%}
{%- if page_title is not defined -%}
    {%- set page_title = page_title_key | trans(page_title_params ?? {}, page_title_domain) -%}
{%- endif -%}

{%- set page_title_suffix = page_title_suffix ?? (' | ' ~ ('site.title' | trans)) -%}

{%- block pageTitle %}{{ page_title }}{{ page_title_suffix ?? '' }}{% endblock -%}

{% block head %}
    {%- block stylesheets -%}
        {{- encore_entry_link_tags('app', attributes={
            nonce: csp_nonce('style')
        }) -}}
    {%- endblock -%}
    {% if env_google_site_verification ?? false %}<meta name="google-site-verification" content="{{ env_google_site_verification }}" />{% endif %}
{% endblock %}

{% block bodyEnd %}
    {%- block javascripts -%}
        {{- encore_entry_script_tags('app', attributes={
            nonce: csp_nonce('script')
        }) -}}
        {{- include('includes/smartlook-session-recording.html.twig') -}}
    {%- endblock -%}
{% endblock %}

{%- block headerBar -%}
    {%- from "@GhostGovUkFrontend/components/macros.html.twig" import header -%}
    {%- if env_label_frontend ?? false -%}
        <style nonce="{{ csp_nonce('style') }}">
            #envLabel {
                {% if env_label_colour ?? false %}color: {{ env_label_colour }};{% endif %}
                {% if env_label_background ?? false %}background: {{ env_label_background }};{% endif %}
            }
            #session-reminder {display:none;}
        </style>
        <div class="govuk-warning-header" id="envLabel">
            {{ env_label_frontend | raw }}
        </div>
    {%- endif -%}
    {{- header({
        classes: 'govuk-header--full-width-border'
    }) -}}
{%- endblock -%}

{%- block phaseBanner -%}
    {%- block navigation %}{% endblock -%}
{%- endblock -%}

{%- block beforeMainWrapper -%}
    {%- from "@GhostGovUkFrontend/components/macros.html.twig" import breadcrumbs as breadcrumbsComponent -%}

    {{- parent() -}}

    {%- if breadcrumbs is not defined and linksBuilder is defined -%}
        {%- set breadcrumbs = linksBuilder.breadcrumbs -%}
    {%- endif -%}

    {%- if (breadcrumbs ?? []) | length > 1 -%}
        {{- breadcrumbsComponent({items: breadcrumbs}) -}}
    {%- endif -%}
{%- endblock -%}

{%- block beforeContent -%}
    {{- parent() -}}

    {%- from '@GhostGovUkFrontend/components/macros.html.twig' import notificationBanner -%}
    {%- if maintenanceWarningBanner ?? null -%}
        {{- notificationBanner(maintenanceWarningBanner) -}}
    {%- endif -%}

    {%- if page_heading is not defined -%}
        {%- set page_heading = page_heading_key is defined ?
            page_heading_key | trans(page_heading_params ?? {}, page_heading_domain ?? page_title_domain) :
            page_title
        -%}
    {%- endif -%}

    {%- block pageHeading -%}
        <h1 class="{{ page_heading_class ?? 'govuk-heading-l' }}">{{ page_heading }}</h1>
    {%- endblock -%}
{%- endblock -%}
