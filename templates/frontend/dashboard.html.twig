{%- extends 'frontend/base.html.twig' -%}

{%- set page_title = breadcrumbBuilder.titleFor('dashboard') -%}
{%- set current_menu = 'dashboard' -%}

{%- block content -%}
    {% from "@GhostGovUkFrontend/components/macros.html.twig" import taskListStart, taskListEnd, taskListItem %}

    {%- for recipient in recipients -%}
        <h2 class="govuk-heading-m">{{ recipient.name }}</h2>

        {# TODO: At a later date, this can be split into separate "outstanding"
                 and "completed" return pages, and paginated
        #}

        {{- taskListStart() -}}
        {%- for fundAward in recipient.fundAwards -%}
            {%- for fundReturn in fundAward.returns -%}
                {%- set tag = fundReturn.signoffUser is null ? 'in_progress' : 'complete' -%}
                {{- taskListItem({
                    title: {text: fundAward.type.name ~ ': ' ~ fundReturn.year ~ ' Q' ~ fundReturn.quarter},
                    href: path('app_fund_return', {id: fundReturn.id}),
                    status: {tag: {
                        text: "tags.#{tag}.name" | trans,
                        classes: "govuk-tag--" ~ ("tags.#{tag}.colour" | trans),
                    }},
                }, loop.index) -}}
            {%- endfor -%}
        {%- endfor -%}
        {{- taskListEnd() -}}
    {%- endfor -%}
{%- endblock -%}
